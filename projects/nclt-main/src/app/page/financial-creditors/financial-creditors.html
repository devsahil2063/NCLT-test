<div class="p-2 bg-gray-50 min-h-screen">
  <p-card class="shadow-sm mb-4">
    <!-- Header -->
    <div class="flex items-center justify-between">
      <div>
        <h2 class="section-heading">Financial Creditors</h2>
        <p class="section-subheading">List of all financial creditors and their claims</p>
      </div>
      <p-button label="Add Financial Creditor" icon="pi pi-plus" severity="danger" (click)="openAddDialog()"
        size="small" />
    </div>
  </p-card>

  <p-card class="shadow-sm p-0! custom-card">
    <!-- Table -->
    <p-table [value]="creditors" [tableStyle]="{ 'min-width': '100%' }" showGridlines class="custom-table">
      <ng-template pTemplate="header">
        <tr>
          <th class="text-left">Sr. No</th>
          <th class="text-left">Name of Financial Creditor</th>
          <th class="text-left">Amount of Claim Lodged</th>
          <th class="text-left">Admitted Claim Amount</th>
          <th class="text-left">% Share</th>
          <th class="text-left">Security Interest</th>
          <th class="text-left">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-creditor>
        <tr>
          <td>{{ creditor.srNo }}</td>
          <td>{{ creditor.name }}</td>
          <td>₹{{ creditor.claimAmount | number: '1.2-2' }}</td>
          <td>₹{{ creditor.admittedAmount | number: '1.2-2' }}</td>
          <td>{{ creditor.sharePercentage | number: '1.2-2' }}%</td>
          <td>
            <span [class]="getSecurityClass(creditor.isSecured)">
              {{ creditor.isSecured ? 'Secured' : 'Unsecured' }}
            </span>
          </td>
          <td>
            <div class="flex items-center gap-2">
              <button (click)="openEditDialog(creditor)" class="p-2 hover:bg-gray-100 rounded transition-colors"
                title="Edit">
                <i class="pi pi-pencil text-gray-600"></i>
              </button>
              <button (click)="deleteCreditor(creditor)" class="p-2 hover:bg-red-50 rounded transition-colors"
                title="Delete">
                <i class="pi pi-trash text-red-500"></i>
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7" class="text-center text-gray-500 py-8">
            No financial creditors added yet. Click "Add Financial Creditor" to get started.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>

  <!-- Add/Edit Financial Creditor Dialog -->
  <p-dialog [header]="editMode ? 'Edit Financial Creditor' : 'Add Financial Creditor'" [(visible)]="showDialog"
    [modal]="true" [closable]="true" [style]="{ width: '40vw' }" [draggable]="false" [resizable]="false">
    <p class="page-subheading">
      {{
      editMode
      ? 'Update financial creditor details and claim information'
      : 'Enter financial creditor details and claim information'
      }}
    </p>
    <p-divider></p-divider>

    <div class="flex flex-col gap-6">
      <!-- Name of Financial Creditor -->
      <div class="flex flex-col gap-2">
        <label class="field-label">
          Name of Financial Creditor <span class="text-red-500">*</span>
        </label>
        <input type="text" pInputText [(ngModel)]="formData.name" placeholder="Enter creditor name" class="w-full"
          pSize="small" />
      </div>

      <!-- Two Column Layout for Amounts -->
      <div class="grid grid-cols-2 gap-6">
        <!-- Amount of Claim Lodged -->
        <div class="flex flex-col gap-2">
          <label class="field-label">
            Amount of Claim Lodged <span class="text-red-500">*</span>
          </label>
          <p-inputnumber [(ngModel)]="formData.claimAmount" mode="currency" currency="INR" locale="en-IN"
            placeholder="Enter claim amount" class="w-full" size="small" />
        </div>

        <!-- Admitted Claim Amount -->
        <div class="flex flex-col gap-2">
          <label class="field-label">
            Admitted Claim Amount <span class="text-red-500">*</span>
          </label>
          <p-inputnumber [(ngModel)]="formData.admittedAmount" mode="currency" currency="INR" locale="en-IN"
            placeholder="Enter admitted amount" class="w-full" size="small" />
        </div>
      </div>

      <!-- Security Interest -->
      <div class="flex flex-col gap-2">
        <label class="field-label">
          Security Interest <span class="text-red-500">*</span>
        </label>
        <p-select [(ngModel)]="formData.isSecured" [options]="securityOptions" optionLabel="label" optionValue="value"
          placeholder="Select security interest" class="w-full" size="small" />
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-end gap-3 mt-6">
        <p-button label="Cancel" [outlined]="true" severity="secondary" (click)="closeDialog()" size="small" />
        <p-button [label]="editMode ? 'Update Creditor' : '+ Add Creditor'" severity="danger" (click)="saveCreditor()"
          [disabled]="!isFormValid()" size="small" />
      </div>
    </ng-template>
  </p-dialog>
</div>